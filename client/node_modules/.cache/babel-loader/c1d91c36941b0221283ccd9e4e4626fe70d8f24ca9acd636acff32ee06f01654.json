{"ast":null,"code":"import axios from \"axios\";\nimport { handleRefreshToken } from \"./authServices\";\naxios.defaults.baseURL = \"http://localhost:5001/api/\";\naxios.interceptors.request.use(function (config) {\n  config.headers[\"authorization\"] = `Bearer ${localStorage.getItem(\"accessToken\")}`;\n  config.headers[\"refresh_token\"] = localStorage.getItem(\"refreshToken\") || \"\";\n  return config;\n}, function (error) {\n  return Promise.reject(error);\n});\n\n//error and response\n\naxios.interceptors.response.use(function (response) {\n  //any status that lie within 2xx will trigger this\n  console.log(\"success status request\", response);\n  return response;\n}, async error => {\n  //save original request\n  const originalRequest = error.config;\n  if (error.response.status === 401 && originalRequest.url.includes(\"refresh-token\")) {\n    //this means refresh token route is being called and refresh token is invalid\n    //clear everything and show whatever the message needed\n    //TODO redirect to logout route\n    //TODO clear all the access and refresh token\n    return Promise.reject(error);\n  } else if (error.response.status === 401 && !originalRequest._retry) {\n    originalRequest._retry = true;\n\n    //call refresh token handler\n    await handleRefreshToken();\n    return axios(originalRequest);\n  }\n  return Promise.reject(error);\n});\nexport default axios;","map":{"version":3,"names":["axios","handleRefreshToken","defaults","baseURL","interceptors","request","use","config","headers","localStorage","getItem","error","Promise","reject","response","console","log","originalRequest","status","url","includes","_retry"],"sources":["C:/Users/rushi/Desktop/meanstackproject2/easy-link-app/client/src/Services/httpClient.ts"],"sourcesContent":["import axios from \"axios\";\r\nimport { handleRefreshToken } from \"./authServices\";\r\n\r\naxios.defaults.baseURL = \"http://localhost:5001/api/\";\r\n\r\naxios.interceptors.request.use(\r\n  function (config) {\r\n    config.headers[\"authorization\"] = `Bearer ${localStorage.getItem(\r\n      \"accessToken\"\r\n    )}`;\r\n    config.headers[\"refresh_token\"] =\r\n      localStorage.getItem(\"refreshToken\") || \"\";\r\n\r\n    return config;\r\n  },\r\n  function (error) {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n//error and response\r\n\r\naxios.interceptors.response.use(\r\n  function (response) {\r\n    //any status that lie within 2xx will trigger this\r\n    console.log(\"success status request\", response);\r\n    return response;\r\n  },\r\n  async (error) => {\r\n    //save original request\r\n    const originalRequest = error.config;\r\n\r\n    if (\r\n      error.response.status === 401 &&\r\n      originalRequest.url.includes(\"refresh-token\")\r\n    ) {\r\n      //this means refresh token route is being called and refresh token is invalid\r\n      //clear everything and show whatever the message needed\r\n      //TODO redirect to logout route\r\n      //TODO clear all the access and refresh token\r\n      return Promise.reject(error);\r\n    } else if (error.response.status === 401 && !originalRequest._retry) {\r\n      originalRequest._retry = true;\r\n\r\n      //call refresh token handler\r\n      await handleRefreshToken();\r\n\r\n      return axios(originalRequest);\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default axios;\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,kBAAkB,QAAQ,gBAAgB;AAEnDD,KAAK,CAACE,QAAQ,CAACC,OAAO,GAAG,4BAA4B;AAErDH,KAAK,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CAC5B,UAAUC,MAAM,EAAE;EAChBA,MAAM,CAACC,OAAO,CAAC,eAAe,CAAC,GAAI,UAASC,YAAY,CAACC,OAAO,CAC9D,aAAa,CACb,EAAC;EACHH,MAAM,CAACC,OAAO,CAAC,eAAe,CAAC,GAC7BC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC,IAAI,EAAE;EAE5C,OAAOH,MAAM;AACf,CAAC,EACD,UAAUI,KAAK,EAAE;EACf,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CAAC,CACF;;AAED;;AAEAX,KAAK,CAACI,YAAY,CAACU,QAAQ,CAACR,GAAG,CAC7B,UAAUQ,QAAQ,EAAE;EAClB;EACAC,OAAO,CAACC,GAAG,CAAC,wBAAwB,EAAEF,QAAQ,CAAC;EAC/C,OAAOA,QAAQ;AACjB,CAAC,EACD,MAAOH,KAAK,IAAK;EACf;EACA,MAAMM,eAAe,GAAGN,KAAK,CAACJ,MAAM;EAEpC,IACEI,KAAK,CAACG,QAAQ,CAACI,MAAM,KAAK,GAAG,IAC7BD,eAAe,CAACE,GAAG,CAACC,QAAQ,CAAC,eAAe,CAAC,EAC7C;IACA;IACA;IACA;IACA;IACA,OAAOR,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;EAC9B,CAAC,MAAM,IAAIA,KAAK,CAACG,QAAQ,CAACI,MAAM,KAAK,GAAG,IAAI,CAACD,eAAe,CAACI,MAAM,EAAE;IACnEJ,eAAe,CAACI,MAAM,GAAG,IAAI;;IAE7B;IACA,MAAMpB,kBAAkB,EAAE;IAE1B,OAAOD,KAAK,CAACiB,eAAe,CAAC;EAC/B;EACA,OAAOL,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CAAC,CACF;AAED,eAAeX,KAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}